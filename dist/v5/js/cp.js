(function(){"use strict";var h=document.createElement("style");h.textContent=`.ap-grid{display:grid;grid-template-columns:1fr;gap:1rem;align-items:start;margin-bottom:0}@media(min-width:768px){.ap-grid{grid-template-columns:1fr 1fr}}.ap-grid label{display:block;margin-bottom:.25rem;font-weight:700}.ap-grid p{margin-top:0;font-size:.75rem;line-height:1rem;color:#6b7280}.prose a span.invisible{width:0;display:inline-block;overflow:hidden;vertical-align:bottom}.prose a span.ellipsis:after{content:"..."}.delete-btn:hover,button.delete-btn:hover{color:#dc2626!important}.prose .quote-inline{display:none}.ap-stack-panel{display:flex;flex-direction:column;overflow:hidden;border-radius:.75rem;box-shadow:0 25px 50px -12px #00000040;background-color:#fff}.ap-stack-header{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1.5rem;flex-shrink:0;border-bottom:1px solid #e5e5e5}.ap-stack-title{margin:0;font-size:1rem;font-weight:600;color:#171717}.ap-stack-close-btn{display:flex;align-items:center;justify-content:center;padding:.25rem;border:none;background:none;border-radius:.375rem;cursor:pointer;color:#a3a3a3}.ap-stack-close-btn:hover{color:#525252;background-color:#f5f5f5}.ap-stack-content{flex:1;overflow-y:auto}.ap-stack-footer{display:flex;justify-content:flex-end;gap:.5rem;padding:1rem;flex-shrink:0;border-top:1px solid #e5e5e5;background-color:#fafafa}.ap-stack-overlay{background:#17171780}html.dark .ap-stack-overlay,html.is-dark .ap-stack-overlay,html.isdark .ap-stack-overlay{background:#171717b3}html.dark .ap-stack-panel,html.is-dark .ap-stack-panel,html.isdark .ap-stack-panel{background-color:#171717}html.dark .ap-stack-header,html.is-dark .ap-stack-header,html.isdark .ap-stack-header{border-bottom-color:#262626}html.dark .ap-stack-title,html.is-dark .ap-stack-title,html.isdark .ap-stack-title{color:#f5f5f5}html.dark .ap-stack-close-btn,html.is-dark .ap-stack-close-btn,html.isdark .ap-stack-close-btn{color:#737373}html.dark .ap-stack-close-btn:hover,html.is-dark .ap-stack-close-btn:hover,html.isdark .ap-stack-close-btn:hover{color:#d4d4d4;background-color:#262626}html.dark .ap-stack-footer,html.is-dark .ap-stack-footer,html.isdark .ap-stack-footer{background-color:#262626;border-top-color:#262626}.ap-json-viewer{font-family:SF Mono,Fira Code,Fira Mono,Roboto Mono,monospace;font-size:.8125rem;line-height:1.5;white-space:pre;overflow:auto;background-color:#f8fafc;color:#1e293b;border-radius:.375rem;padding:1rem}.ap-json-key{color:#db2777}.ap-json-string{color:#16a34a}.ap-json-number{color:#2563eb}.ap-json-bool{color:#ea580c}.ap-json-null{color:#64748b;font-style:italic}html.dark .ap-json-viewer,html.is-dark .ap-json-viewer,html.isdark .ap-json-viewer{background-color:#1e1e2e;color:#cdd6f4}html.dark .ap-json-key,html.is-dark .ap-json-key,html.isdark .ap-json-key{color:#f38ba8}html.dark .ap-json-string,html.is-dark .ap-json-string,html.isdark .ap-json-string{color:#a6e3a1}html.dark .ap-json-number,html.is-dark .ap-json-number,html.isdark .ap-json-number{color:#89b4fa}html.dark .ap-json-bool,html.is-dark .ap-json-bool,html.isdark .ap-json-bool{color:#fab387}html.dark .ap-json-null,html.is-dark .ap-json-null,html.isdark .ap-json-null{color:#6c7086;font-style:italic}.ap-reply-card{background-color:#fff;border-color:#e5e7eb}.ap-reply-input{background-color:#fff;border-color:#d1d5db;color:#111827}html.dark .ap-reply-card,html.is-dark .ap-reply-card,html.isdark .ap-reply-card{background-color:#262626;border-color:#404040}html.dark .ap-reply-input,html.is-dark .ap-reply-input,html.isdark .ap-reply-input{background-color:#171717;border-color:#404040;color:#d4d4d4}.ap-filter-container{background-color:#e5e7eb;border-color:#e5e7eb}html.dark .ap-filter-container,html.is-dark .ap-filter-container,html.isdark .ap-filter-container{background-color:#171717;border-color:#262626}.ap-filter-btn.active{background-color:#fff;color:#111827;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.ap-filter-btn.inactive{color:#6b7280;font-weight:400}.ap-filter-btn.inactive:hover{color:#374151}html.dark .ap-filter-btn.active,html.is-dark .ap-filter-btn.active,html.isdark .ap-filter-btn.active{background-color:#404040;color:#f5f5f5}html.dark .ap-filter-btn.inactive,html.is-dark .ap-filter-btn.inactive,html.isdark .ap-filter-btn.inactive{color:#a3a3a3}html.dark .ap-filter-btn.inactive:hover,html.is-dark .ap-filter-btn.inactive:hover,html.isdark .ap-filter-btn.inactive:hover{color:#e5e5e5}.btn{display:inline-flex;align-items:center;font-size:.875rem;font-weight:500;line-height:1.25rem;padding:.5rem 1rem;height:2.375rem;border-radius:.25rem;border:1px solid #D3DDE7;background:linear-gradient(180deg,#fff,#f9fafb);background-clip:padding-box;color:#1f2937;cursor:pointer;outline:none}.btn:hover:not(:disabled){background:linear-gradient(180deg,#f3f4f6,#eef2ff)}.btn:disabled{opacity:.6;cursor:not-allowed}.btn-sm{padding:.25rem .5rem;height:2rem}.btn-primary{color:#fff;background:linear-gradient(to bottom,#3b82f6,#2563eb);background-clip:padding-box;border:1px solid #1d4ed8;border-bottom-color:#1e40af;box-shadow:inset 0 1px #60a5fa,0 1px #191e230d,0 3px 2px -1px #1e3a8a26}.btn-primary:hover:not(:disabled){background:linear-gradient(to bottom,#2563eb,#1d4ed8)}.btn-primary:disabled{opacity:.6;cursor:not-allowed}html.dark .btn,html.is-dark .btn,html.isdark .btn{background:linear-gradient(180deg,#2d2d2d,#262626);border-color:#444;color:#e5e5e5}html.dark .btn:hover:not(:disabled),html.is-dark .btn:hover:not(:disabled),html.isdark .btn:hover:not(:disabled){background:linear-gradient(180deg,#3a3a3a,#333)}html.dark .btn-primary,html.is-dark .btn-primary,html.isdark .btn-primary{background:linear-gradient(to bottom,#2563eb,#1d4ed8);border-color:#1e40af;border-bottom-color:#1e3a8a;color:#fff}html.dark .btn-primary:hover:not(:disabled),html.is-dark .btn-primary:hover:not(:disabled),html.isdark .btn-primary:hover:not(:disabled){background:linear-gradient(to bottom,#1d4ed8,#1e40af)}.pagination-container nav[data-v-5bd1ae8c]{display:flex;justify-content:center}.ease-spring[data-v-5bd1ae8c]{transition-timing-function:cubic-bezier(.16,1,.3,1)}.drawer[data-v-5bd1ae8c]{height:calc(100vh - 3.25rem);margin-top:3.25rem}
/*$vite$:1*/`,document.head.appendChild(h);function i(n,t,e,s,o,a,r,c){var l=typeof n=="function"?n.options:n;return t&&(l.render=t,l.staticRenderFns=e,l._compiled=!0),a&&(l._scopeId="data-v-"+a),{exports:n,options:l}}const x={name:"InboxNote",props:{note:{type:Object,required:!0},permissions:{type:Object,default:()=>({update:!1,delete:!1})}},data(){return{isVoting:!1,selectedOptions:[],openEndedResponse:""}},methods:{hasVoted(n){return n.has_voted||n.closed},getPercentage(n,t){return!t.voters_count||t.voters_count===0?0:Math.round(n.count/t.voters_count*100)},formatTime(n){return new Date(n).toLocaleString()},submitVote(n){if(this.isVoting)return;let t=[];if(!n.options||n.options.length===0){if(!this.openEndedResponse.trim())return;t.push(this.openEndedResponse)}else if(Array.isArray(this.selectedOptions)?t=this.selectedOptions.map(s=>s.name):this.selectedOptions&&(t=[this.selectedOptions.name]),t.length===0)return;this.isVoting=!0;const e=(s,o=!0)=>{this.$emit("vote",{note:n,option:{name:s},callback:a=>{o&&(this.isVoting=!1,a&&(n.has_voted=!0,n.voters_count=(n.voters_count||0)+1,n.options&&t.forEach(r=>{const c=n.options.find(l=>l.name===r);c&&(c.count=(c.count||0)+1)})))}})};t.forEach((s,o)=>{e(s,o===t.length-1)})}}};var w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors"},[t.note.is_boost&&t.note.boosted_by?e("div",{staticClass:"px-4 pt-3 flex items-center gap-2 text-gray-500 text-sm"},[e("svg",{staticClass:"h-4 w-4 text-green-600",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"}})]),e("span",{staticClass:"font-semibold text-gray-600 dark:text-gray-400"},[t._v(t._s(t.note.boosted_by.name))]),e("span",{staticClass:"text-gray-400"},[t._v("boosted")])]):t._e(),e("div",{staticClass:"flex gap-4",class:{"px-4 pb-4 pt-1":t.note.is_boost,"p-4":!t.note.is_boost}},[e("div",{staticClass:"flex-shrink-0"},[e("img",{staticClass:"w-12 h-12 rounded-full bg-gray-200 object-cover",attrs:{src:t.note.actor.avatar||"https://www.gravatar.com/avatar/?d=mp",loading:"lazy"}})]),e("div",{staticClass:"flex-1 min-w-0"},[e("div",{staticClass:"flex items-baseline justify-between gap-2"},[e("div",{staticClass:"flex items-center gap-2 min-w-0"},[e("span",{staticClass:"font-bold truncate"},[t._v(t._s(t.note.actor.name))]),e("span",{staticClass:"text-sm text-gray-500 truncate",attrs:{title:t.note.actor.handle}},[t._v(t._s(t.note.actor.handle))])]),e("div",{staticClass:"flex items-center gap-2 flex-shrink-0"},[e("span",{staticClass:"text-xs text-gray-400 whitespace-nowrap",attrs:{title:t.note.date}},[t._v(t._s(t.note.date_human))]),t.note.is_internal&&t.permissions.update?e("button",{staticClass:"text-gray-400 hover:text-blue-500 transition-colors",attrs:{title:"Edit"},on:{click:function(s){return t.$emit("edit",t.note)}}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"}})])]):t._e(),t.permissions.delete?e("button",{staticClass:"text-gray-400 transition-colors delete-btn",attrs:{title:"Delete"},on:{click:function(s){return t.$emit("delete",t.note)}}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"}})])]):t._e()])]),t.note.sensitive?e("div",{staticClass:"mb-2 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded text-sm flex items-center gap-2 text-yellow-800 dark:text-yellow-200 cursor-pointer select-none",on:{click:function(s){t.note.showContent=!t.note.showContent}}},[e("span",[t._v("⚠️")]),e("span",[t._v(t._s(t.note.summary||"Sensitive Content"))])]):t._e(),!t.note.sensitive||t.note.showContent?e("div",{staticClass:"mt-2 prose dark:prose-invert text-sm max-w-none break-words",domProps:{innerHTML:t._s(t.note.content)}}):t._e(),t.note.type==="question"?e("div",{staticClass:"mt-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},[e("div",{staticClass:"flex justify-between items-center mb-2"},[e("span",{staticClass:"text-xs font-bold uppercase text-gray-500"},[t._v("Poll")]),t.note.closed?e("span",{staticClass:"text-xs font-bold text-red-500"},[t._v("Closed")]):t.note.end_time?e("span",{staticClass:"text-xs text-gray-400"},[t._v("Ends "+t._s(t.formatTime(t.note.end_time)))]):t._e()]),!t.note.options||t.note.options.length===0?e("div",{staticClass:"flex flex-col gap-2"},[t.hasVoted(t.note)||t.note.closed?[e("div",{staticClass:"p-3 bg-gray-100 dark:bg-gray-700 rounded text-sm text-gray-500 italic"},[t._v(" Open-ended responses are hidden. ")])]:[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.openEndedResponse,expression:"openEndedResponse"}],staticClass:"input-text w-full text-sm",attrs:{rows:"3",placeholder:"Type your answer...",disabled:t.isVoting},domProps:{value:t.openEndedResponse},on:{input:function(s){s.target.composing||(t.openEndedResponse=s.target.value)}}}),e("div",{staticClass:"flex justify-end mt-2"},[e("button",{staticClass:"btn-primary text-xs px-3 py-1.5",attrs:{disabled:t.isVoting||!t.openEndedResponse.trim()},on:{click:function(s){return t.submitVote(t.note)}}},[t._v(" "+t._s(t.isVoting?"Submitting...":"Submit Answer")+" ")])])]],2):e("div",{staticClass:"flex flex-col gap-2"},[t._l(t.note.options,function(s,o){return e("div",{key:o,staticClass:"relative"},[t.hasVoted(t.note)||t.note.closed?[e("div",{staticClass:"absolute inset-y-0 left-0 bg-blue-100 dark:bg-blue-900/30 rounded",style:{width:t.getPercentage(s,t.note)+"%"}}),e("div",{staticClass:"relative flex items-center justify-between p-2 border border-blue-200 dark:border-blue-800 rounded z-10"},[e("span",{staticClass:"text-sm font-medium"},[t._v(t._s(s.name))]),e("span",{staticClass:"text-xs text-gray-500"},[t._v(" "+t._s(t.getPercentage(s,t.note))+"% ("+t._s(s.count)+") ")])])]:[e("label",{staticClass:"relative flex items-center p-2 border border-gray-200 dark:border-gray-700 rounded hover:bg-white dark:hover:bg-gray-700 cursor-pointer transition-colors"},[t.note.multiple_choice?e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedOptions,expression:"selectedOptions"}],staticClass:"mr-2 text-blue-600 focus:ring-blue-500 rounded",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selectedOptions)?t._i(t.selectedOptions,s)>-1:t.selectedOptions},on:{change:function(a){var r=t.selectedOptions,c=a.target,l=!!c.checked;if(Array.isArray(r)){var d=s,f=t._i(r,d);c.checked?f<0&&(t.selectedOptions=r.concat([d])):f>-1&&(t.selectedOptions=r.slice(0,f).concat(r.slice(f+1)))}else t.selectedOptions=l}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedOptions,expression:"selectedOptions"}],staticClass:"mr-2 text-blue-600 focus:ring-blue-500",attrs:{type:"radio"},domProps:{value:s,checked:t._q(t.selectedOptions,s)},on:{change:function(a){t.selectedOptions=s}}}),e("span",{staticClass:"text-sm font-medium"},[t._v(t._s(s.name))])])]],2)}),!t.hasVoted(t.note)&&!t.note.closed?e("div",{staticClass:"flex justify-end mt-2"},[e("button",{staticClass:"btn-primary text-xs px-3 py-1.5",attrs:{disabled:t.isVoting||!t.openEndedResponse&&t.selectedOptions.length===0&&!t.selectedOptions.name},on:{click:function(s){return t.submitVote(t.note)}}},[t._v(" "+t._s(t.isVoting?"Voting...":"Vote")+" ")])]):t._e()],2),e("div",{staticClass:"mt-2 text-xs text-gray-400 text-right"},[t._v(" "+t._s(t.note.voters_count)+" votes ")])]):t._e(),t.note.attachments&&t.note.attachments.length>0?e("div",{staticClass:"mt-3 flex gap-2"},t._l(t.note.attachments.slice(0,3),function(s,o){return e("div",{key:o,staticClass:"relative flex-1 cursor-pointer group overflow-hidden rounded-lg",on:{click:function(a){return t.$emit("lightbox",{attachments:t.note.attachments,index:o})}}},[e("img",{staticClass:"w-full h-full object-cover transition-transform group-hover:scale-[1.02]",attrs:{src:s.url,alt:s.description,loading:"lazy"}})])}),0):t._e(),t.note.oembed&&t.note.oembed.html?e("div",{staticClass:"mt-3",domProps:{innerHTML:t._s(t.note.oembed.html)}}):t._e(),t.note.link_preview&&!t.note.oembed?e("a",{staticClass:"block mt-3 border rounded-lg overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors group no-underline",attrs:{href:t.note.link_preview.url,target:"_blank"}},[e("div",{staticClass:"flex flex-col sm:flex-row h-full"},[t.note.link_preview.image?e("div",{staticClass:"sm:w-1/3 h-48 sm:h-auto relative overflow-hidden bg-gray-100 dark:bg-gray-900"},[e("img",{staticClass:"absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",attrs:{src:t.note.link_preview.image,loading:"lazy"}})]):t._e(),e("div",{staticClass:"p-4 flex flex-col justify-center flex-1 min-w-0"},[e("h3",{staticClass:"font-bold text-sm line-clamp-2 mb-1"},[t._v(t._s(t.note.link_preview.title))]),e("p",{staticClass:"text-xs text-gray-500 line-clamp-2 mb-2"},[t._v(t._s(t.note.link_preview.description))]),e("div",{staticClass:"flex items-center gap-2 mt-auto"},[t.note.link_preview.icon?e("img",{staticClass:"w-4 h-4 rounded-sm",attrs:{src:t.note.link_preview.icon}}):t._e(),e("span",{staticClass:"text-xs text-gray-400 uppercase tracking-wider"},[t._v(t._s(t.note.link_preview.site_name||"Link"))])])])])]):t._e(),e("div",{staticClass:"mt-3 flex items-center gap-6 text-sm text-gray-500"},[["note","question"].includes(t.note.type)?[t.note.sensitive?e("button",{staticClass:"flex items-center gap-1 hover:text-blue-500 transition-colors",attrs:{title:t.note.showContent?"Hide Content":"Show Content"},on:{click:function(s){t.note.showContent=!t.note.showContent}}},[t.note.showContent?e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"}})]):e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}}),e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"}})])]):t._e(),e("button",{staticClass:"flex items-center gap-1 text-gray-500 hover:text-blue-500 transition-colors",attrs:{title:"Reply"},on:{click:function(s){return t.$emit("reply",t.note)}}},[e("svg",{staticClass:"w-4 h-4",attrs:{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"}})])]),e("button",{staticClass:"flex items-center gap-1 transition-colors",class:t.note.boosted_by_user?"text-green-600":"text-gray-500 hover:text-blue-500",attrs:{title:"Boost"},on:{click:function(s){return t.$emit("boost",t.note)}}},[e("svg",{staticClass:"w-4 h-4",attrs:{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"}})])]),e("button",{staticClass:"flex items-center gap-1 text-gray-500 hover:text-blue-500 transition-colors",attrs:{title:"Quote"},on:{click:function(s){return t.$emit("quote",t.note)}}},[e("svg",{staticClass:"w-4 h-4",attrs:{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"}})])]),e("button",{staticClass:"flex items-center gap-1 transition-colors",class:t.note.liked_by_user?"text-yellow-500":"text-gray-500 hover:text-blue-500",attrs:{title:"Like"},on:{click:function(s){return t.$emit("like",t.note)}}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:t.note.liked_by_user?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"}})]),e("span",[t._v(t._s(t.note.counts?.likes||0))])]),t.note.related_activity_count>0||t.note.related_activity_count?e("button",{staticClass:"flex items-center gap-1 text-gray-500 hover:text-blue-500 transition-colors",attrs:{title:"View History"},on:{click:function(s){return t.$emit("history",t.note)}}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"}})])]):t._e(),e("button",{staticClass:"flex items-center gap-1 text-gray-500 hover:text-blue-500 transition-colors",attrs:{title:"View Thread"},on:{click:function(s){return t.$emit("thread",t.note)}}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 492.43313 470.25731"}},[e("g",{attrs:{transform:"matrix(0.75674108,0,0,0.70536422,57.817645,55.147289)"}},[e("path",{attrs:{d:"m 16.695312,-2.5546875 c -10.7064892,0 -19.2499995,8.5435103 -19.2499995,19.2499995 v 38.957032 c 0,29.137041 23.5058235,52.640626 52.6425785,52.640626 H 64.228516 V 403.70703 H 50.087891 c -29.136755,0 -52.6425785,23.50358 -52.6425785,52.64063 v 38.95703 c 0,10.7065 8.5434901,19.25 19.2499995,19.25 H 384 c 10.71306,0 19.25,-8.53506 19.25,-19.25 v -38.95703 c 0,-29.13649 -23.50414,-52.64063 -52.64063,-52.64063 H 336.4668 v -28.2832 h 30.83789 c 38.29372,10e-6 69.33789,-31.04205 69.33789,-69.33594 v -66.7832 c 0,-17.11722 13.71869,-30.83789 30.83594,-30.83789 h 27.82617 c 10.71308,0 19.25,-8.53502 19.25,-19.25 0,-10.7065 -8.54352,-19.25 -19.25,-19.25 h -27.82617 c -38.29404,0 -69.33789,31.04386 -69.3379,69.33789 v 66.7832 c 0,17.11687 -13.71907,30.83594 -30.83593,30.83594 H 336.4668 V 108.29297 h 14.14257 c 29.13649,0 52.64063,-23.504139 52.64063,-52.640626 V 16.695312 C 403.25,5.9803688 394.71306,-2.5546875 384,-2.5546875 Z m 19.25,38.4999995 H 364.75 v 19.707032 c 0,7.961761 -6.18114,14.140625 -14.14258,14.140625 H 50.087891 c -7.961438,0 -14.142579,-6.178863 -14.142579,-14.140625 z M 102.72852,108.29297 H 297.9668 v 28.2832 H 102.72852 Z m 0,66.7832 H 297.9668 v 28.28125 H 102.72852 Z m 0,66.7832 H 297.9668 v 28.28125 H 102.72852 Z m 0,66.78321 H 297.9668 v 28.28125 H 102.72852 Z m 0,66.78125 H 297.9668 v 28.2832 H 102.72852 Z m -52.640629,66.7832 H 350.60937 c 7.96039,0 14.14063,6.18025 14.14063,14.14063 v 19.70703 H 35.945312 v -19.70703 c 0,-7.96177 6.181139,-14.14063 14.142579,-14.14063 z"}})])]),e("span",[t._v(t._s(t.note.counts?.replies||0))])])]:t._e(),t.note.actions&&t.note.actions.view?e("a",{staticClass:"flex items-center gap-1 text-gray-500 hover:text-blue-500 transition-colors",attrs:{href:t.note.actions.view,target:"_blank",title:"View Original"}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"}})])]):t._e(),t.note.activitypub_json?e("button",{staticClass:"flex items-center gap-1 text-gray-500 hover:text-blue-500 transition-colors",attrs:{title:"View Activity JSON"},on:{click:function(s){return t.$emit("json",t.note)}}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"}})])]):t._e()],2),t.note.parent?e("div",{staticClass:"mt-4 pt-4 border-l-4 border-gray-300 dark:border-gray-600 pl-4 ml-2 bg-gray-50/50 dark:bg-gray-800/30 rounded-r-lg"},[e("div",{staticClass:"text-xs text-gray-500 mb-2 flex items-center gap-1 font-semibold uppercase tracking-wider"},[e("svg",{staticClass:"h-3 w-3",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"}})]),t._v(" In reply to: ")]),e("inbox-note",{attrs:{note:t.note.parent,permissions:t.permissions},on:{reply:function(s){return t.$emit("reply",s)},boost:function(s){return t.$emit("boost",s)},like:function(s){return t.$emit("like",s)},history:function(s){return t.$emit("history",s)},thread:function(s){return t.$emit("thread",s)},json:function(s){return t.$emit("json",s)},lightbox:function(s){return t.$emit("lightbox",s)},delete:function(s){return t.$emit("delete",s)},edit:function(s){return t.$emit("edit",s)},vote:function(s){return t.$emit("vote",s)}}})],1):t._e(),t.note.quote?e("div",{staticClass:"mt-4 pt-4 border-l-4 border-purple-300 dark:border-purple-600 pl-4 ml-2 bg-purple-50/50 dark:bg-purple-900/10 rounded-r-lg"},[e("div",{staticClass:"text-xs text-gray-500 mb-2 flex items-center gap-1 font-semibold uppercase tracking-wider"},[e("svg",{staticClass:"h-3 w-3",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"}})]),t._v(" Quoting: ")]),e("inbox-note",{attrs:{note:t.note.quote,permissions:t.permissions},on:{reply:function(s){return t.$emit("reply",s)},boost:function(s){return t.$emit("boost",s)},quote:function(s){return t.$emit("quote",s)},like:function(s){return t.$emit("like",s)},history:function(s){return t.$emit("history",s)},thread:function(s){return t.$emit("thread",s)},json:function(s){return t.$emit("json",s)},lightbox:function(s){return t.$emit("lightbox",s)},delete:function(s){return t.$emit("delete",s)},edit:function(s){return t.$emit("edit",s)},vote:function(s){return t.$emit("vote",s)}}})],1):t._e(),t._t("reply-editor")],2)])])},k=[],C=i(x,w,k,!1,null,null);const p=C.exports,$={props:{open:{type:Boolean,default:!1},title:{type:String,default:""},inset:{type:Boolean,default:!1}},emits:["closed"],mounted(){document.body.appendChild(this.$el)},watch:{open(n){n?(document.body.style.overflow="hidden",this._escHandler=t=>{t.key==="Escape"&&this.$emit("closed")},document.addEventListener("keydown",this._escHandler)):(document.body.style.overflow="",this._escHandler&&document.removeEventListener("keydown",this._escHandler))}},beforeUnmount(){this.cleanup()},beforeDestroy(){this.cleanup()},methods:{cleanup(){document.body.style.overflow="",this._escHandler&&document.removeEventListener("keydown",this._escHandler),this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}}};var j=function(){var t=this,e=t._self._c;return e("div",[t.open?e("div",{staticStyle:{position:"fixed",inset:"0","z-index":"9999"}},[e("div",{staticClass:"ap-stack-overlay",staticStyle:{position:"absolute",inset:"0"},on:{click:function(s){return t.$emit("closed")}}}),e("div",{staticClass:"ap-stack-panel",staticStyle:{position:"absolute",top:"0.5rem",bottom:"0.5rem",right:"0.5rem",width:"100%","max-width":"48rem"},on:{click:function(s){s.stopPropagation()}}},[t.title?e("div",{staticClass:"ap-stack-header"},[e("h2",{staticClass:"ap-stack-title"},[t._v(t._s(t.title))]),e("button",{staticClass:"ap-stack-close-btn",on:{click:function(s){return t.$emit("closed")}}},[e("svg",{staticStyle:{height:"1rem",width:"1rem"},attrs:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"}})])])]):t._e(),e("div",{staticClass:"ap-stack-content",style:{padding:t.inset?"0":"1.5rem"}},[t._t("default")],2),t.$slots["footer-end"]?e("div",{staticClass:"ap-stack-footer"},[t._t("footer-end")],2):t._e()])]):t._e()])},N=[],S=i($,j,N,!1,null,null);const u=S.exports,P={components:{InboxStack:u},props:{open:{type:Boolean,required:!0},content:{type:[String,Object],default:""}},methods:{highlightJson(n){return typeof n!="string"&&(n=JSON.stringify(n,void 0,2)),n?(n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(t){var e="ap-json-number";return/^"/.test(t)?/:$/.test(t)?e="ap-json-key":e="ap-json-string":/true|false/.test(t)?e="ap-json-bool":/null/.test(t)&&(e="ap-json-null"),'<span class="'+e+'">'+t+"</span>"})):""}}};var A=function(){var t=this,e=t._self._c;return e("inbox-stack",{attrs:{open:t.open,title:"ActivityPub JSON",inset:""},on:{closed:function(s){return t.$emit("close")}},scopedSlots:t._u([{key:"footer-end",fn:function(){return[e("button",{staticClass:"btn",on:{click:function(s){return t.$emit("close")}}},[t._v("Close")])]},proxy:!0}])},[e("pre",{staticClass:"ap-json-viewer",domProps:{innerHTML:t._s(t.highlightJson(t.content))}})])},F=[],M=i(P,A,F,!1,null,null);const I=M.exports,R={components:{InboxStack:u},props:{open:{type:Boolean,required:!0},noteId:{type:[String,Number],default:null},apiUrl:{type:String,required:!0}},data(){return{loading:!1,activities:[]}},watch:{open(n){n&&this.noteId&&this.fetchHistory()},noteId(n){this.open&&n&&this.fetchHistory()}},methods:{fetchHistory(){this.loading=!0,this.activities=[],fetch(`${this.apiUrl}/history/${this.noteId}`).then(n=>n.json()).then(n=>{this.activities=n}).finally(()=>{this.loading=!1})}}};var q=function(){var t=this,e=t._self._c;return e("inbox-stack",{attrs:{open:t.open,title:"Activity History",inset:""},on:{closed:function(s){return t.$emit("close")}}},[t.loading?e("div",{staticClass:"py-8 text-center text-gray-500"},[t._v(" Loading history... ")]):t.activities.length===0?e("div",{staticClass:"py-8 text-center text-gray-500"},[t._v(" No related activities found. ")]):e("div",{staticClass:"flex flex-col divide-y dark:divide-dark-800"},t._l(t.activities,function(s){return e("div",{key:s.id,staticClass:"p-4 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"},[e("div",{staticClass:"flex gap-3"},[e("div",{staticClass:"flex-shrink-0"},[e("img",{staticClass:"w-10 h-10 rounded-full bg-gray-200 object-cover",attrs:{src:s.actor.avatar||"https://www.gravatar.com/avatar/?d=mp",loading:"lazy"}})]),e("div",{staticClass:"flex-1 min-w-0"},[e("div",{staticClass:"flex items-center justify-between gap-2"},[e("div",{staticClass:"flex items-center gap-2"},[e("span",{staticClass:"font-bold text-sm"},[t._v(t._s(s.actor.name))]),e("span",{staticClass:"text-xs text-gray-500"},[t._v(t._s(s.type))])]),e("span",{staticClass:"text-xs text-gray-400"},[t._v(t._s(s.date_human))])]),e("div",{staticClass:"text-sm mt-1 text-gray-700 dark:text-gray-300",domProps:{innerHTML:t._s(s.content)}}),e("div",{staticClass:"mt-2 flex items-center gap-3"},[s.activitypub_json?e("button",{staticClass:"flex items-center gap-1 text-xs text-gray-400 hover:text-blue-500 transition-colors",attrs:{title:"View JSON"},on:{click:function(o){return t.$emit("view-json",s)}}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"}})])]):t._e(),s.object?e("a",{staticClass:"flex items-center gap-1 text-xs text-gray-400 hover:text-blue-500 transition-colors",attrs:{href:typeof s.object=="string"?s.object:s.object.id,target:"_blank",title:"View Source"}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"}})])]):t._e()])])])])}),0)])},B=[],O=i(R,q,B,!1,null,null);const U=O.exports,H={props:{actors:{type:Array,default:()=>[]},actorId:{type:[String,Number],default:null},content:{type:String,default:""},contentWarning:{type:String,default:""},loading:{type:Boolean,default:!1}}};var z=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mt-4 p-4 rounded-lg border shadow-sm animate-fade-in-down ap-reply-card"},[e("div",{staticClass:"flex flex-col gap-3"},[e("div",{staticClass:"flex items-center gap-2"},[e("label",{staticClass:"text-xs text-gray-500 uppercase font-bold"},[t._v("Reply As:")]),e("select",{staticClass:"text-sm rounded-md shadow-sm ap-reply-input",domProps:{value:t.actorId},on:{input:function(s){return t.$emit("update:actorId",s.target.value)}}},t._l(t.actors,function(s){return e("option",{key:s.id,domProps:{value:s.id}},[t._v(t._s(s.name)+" ("+t._s(s.handle)+")")])}),0)]),e("div",{staticClass:"mb-3"},[e("input",{staticClass:"input-text w-full text-sm",attrs:{type:"text",placeholder:"Content Warning (optional)"},domProps:{value:t.contentWarning},on:{input:function(s){return t.$emit("update:contentWarning",s.target.value)}}})]),e("div",{staticClass:"min-h-[150px]"},[e("markdown-fieldtype",{attrs:{value:t.content,"model-value":t.content,config:{cheatsheet:!0,container:"assets",buttons:["bold","italic","unorderedlist","orderedlist","quote","link","image","table"]}},on:{input:function(s){return t.$emit("update:content",s)},"update:modelValue":function(s){return t.$emit("update:content",s)},"update:value":function(s){return t.$emit("update:content",s)}}})],1),e("div",{staticClass:"flex justify-end gap-2 mt-3"},[e("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(s){return t.$emit("cancel")}}},[t._v("Cancel")]),e("button",{staticClass:"btn-primary",attrs:{type:"button",disabled:t.loading},on:{click:function(s){return t.$emit("submit")}}},[t._v(" "+t._s(t.loading?"Sending...":"Reply")+" ")])])])])},T=[],V=i(H,z,T,!1,null,null);const g=V.exports,L={components:{InboxStack:u,InboxNote:p,InboxReplyForm:g},props:{open:{type:Boolean,required:!0},noteId:{type:[String,Number],default:null},apiUrl:{type:String,required:!0},activeReplyId:{type:[String,Number],default:null},replyForm:{type:Object,required:!0},sendingReply:{type:Boolean,default:!1},actors:{type:Array,default:()=>[]},permissions:{type:Object,default:()=>({update:!1,delete:!1})}},emits:["close","update:activeReplyId","update:replyForm","submit-reply","reply","boost","like","history","thread","json","lightbox","delete","edit"],data(){return{loading:!1,items:[]}},watch:{open(n){n&&this.noteId&&this.fetchThread()},noteId(n){this.open&&n&&this.fetchThread()}},methods:{fetchThread(){this.loading=!0,this.items=[],fetch(`${this.apiUrl}/thread/${this.noteId}`).then(n=>n.json()).then(n=>{this.items=n}).finally(()=>{this.loading=!1})}}};var D=function(){var t=this,e=t._self._c;return e("inbox-stack",{attrs:{open:t.open,title:"Thread",inset:""},on:{closed:function(s){return t.$emit("close")}}},[t.loading?e("div",{staticClass:"py-8 text-center text-gray-500"},[t._v(" Loading thread... ")]):t.items.length===0?e("div",{staticClass:"py-8 text-center text-gray-500"},[t._v(" Thread is empty. ")]):e("div",{staticClass:"flex flex-col"},t._l(t.items,function(s,o){return e("div",{key:s.id||o,staticClass:"relative",class:{"bg-blue-50 dark:bg-dark-800":s.is_focus}},[s.depth>0?e("div",{staticClass:"absolute left-6 top-0 bottom-0 border-l-2 border-gray-200 dark:border-gray-700",style:{left:s.depth*1.5+"rem"}}):t._e(),e("div",{staticClass:"p-4 border-b dark:border-dark-800",style:{"margin-left":s.depth*1.5+"rem"}},[e("inbox-note",{attrs:{note:s,permissions:t.permissions},on:{reply:function(a){return t.$emit("reply",s)},boost:function(a){return t.$emit("boost",s)},like:function(a){return t.$emit("like",s)},history:function(a){return t.$emit("history",s)},thread:function(a){return t.$emit("thread",s)},json:function(a){return t.$emit("json",s)},lightbox:function(a){return t.$emit("lightbox",{attachments:a.attachments,index:a.index})},delete:function(a){return t.$emit("delete",s)},edit:function(a){return t.$emit("edit",s)}},scopedSlots:t._u([{key:"reply-editor",fn:function(){return[t.activeReplyId===s.id?e("inbox-reply-form",{attrs:{actors:t.actors,"actor-id":t.replyForm.actor_id,content:t.replyForm.content,"content-warning":t.replyForm.content_warning,loading:t.sendingReply},on:{"update:actorId":function(a){return t.$emit("update:replyForm",{...t.replyForm,actor_id:a})},"update:content":function(a){return t.$emit("update:replyForm",{...t.replyForm,content:a})},"update:contentWarning":function(a){return t.$emit("update:replyForm",{...t.replyForm,content_warning:a})},cancel:function(a){return t.$emit("update:activeReplyId",null)},submit:function(a){return t.$emit("submit-reply",s)}}}):t._e()]},proxy:!0}],null,!0)})],1)])}),0)])},E=[],Q=i(L,D,E,!1,null,null);const v=Q.exports,J={props:{currentFilter:{type:String,default:"all"},canCreateNote:{type:Boolean,default:!1},showNewDropdown:{type:Boolean,default:!1}}};var W=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex rounded-lg p-1 gap-1 border ap-filter-container items-center"},[t._l(["all","activities","mentions"],function(s){return e("button",{key:s,staticClass:"px-3 py-1 rounded-md text-sm font-medium transition-colors capitalize ap-filter-btn",class:t.currentFilter===s?"active":"inactive",on:{click:function(o){return t.$emit("filter-change",s)}}},[t._v(" "+t._s(s)+" ")])}),t.canCreateNote?e("div",{staticClass:"btn-group relative flex items-center ml-2"},[e("button",{staticClass:"btn-primary !rounded-r-none pr-3 focus:z-10",attrs:{type:"button"},on:{click:function(s){return t.$emit("create-note")}}},[t._v(" New Note ")]),e("button",{staticClass:"btn-primary !rounded-l-none px-2 border-l border-white/20 -ml-px flex items-center h-full focus:z-10",attrs:{type:"button"},on:{click:function(s){return t.$emit("toggle-dropdown")}}},[e("svg",{staticClass:"h-4 w-4",attrs:{fill:"currentColor",viewBox:"0 0 20 20"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"}})])]),t.showNewDropdown?e("div",{staticClass:"absolute right-0 bg-white dark:bg-dark-550 border border-gray-100 dark:border-dark-900 shadow-popover rounded-md z-50 py-1",staticStyle:{top:"2.75em",width:"100%","text-align":"left"}},[e("a",{staticClass:"block px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-dark-600",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.$emit("create-poll")}}},[t._v("New Poll")])]):t._e()]):t._e()],2)},Z=[],G=i(J,W,Z,!1,null,null);const K={components:{InboxFilterBar:G.exports},props:{currentFilter:{type:String,default:"all"},canCreateNote:{type:Boolean,default:!1},showNewDropdown:{type:Boolean,default:!1}}};var X=function(){var t=this,e=t._self._c;return e("header",{staticClass:"flex flex-wrap items-center justify-between gap-4 px-2 sm:px-0 py-6 max-md:pb-8 md:py-8"},[e("h1",{staticClass:"text-[25px] leading-[1.25] st-text-legibility font-medium antialiased flex items-center gap-2.5 md:flex-1"},[t._v("Inbox")]),e("inbox-filter-bar",{attrs:{"current-filter":t.currentFilter,"can-create-note":t.canCreateNote,"show-new-dropdown":t.showNewDropdown},on:{"filter-change":function(s){return t.$emit("filter-change",s)},"create-note":function(s){return t.$emit("create-note")},"toggle-dropdown":function(s){return t.$emit("toggle-dropdown")},"create-poll":function(s){return t.$emit("create-poll")}}})],1)},Y=[],tt=i(K,X,Y,!1,null,null);const et=tt.exports,st={components:{InboxNote:p,InboxReplyForm:g},props:{notes:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Object,required:!0},permissions:{type:Object,default:()=>({update:!1,delete:!1})},actors:{type:Array,default:()=>[]},activeReplyId:{type:[String,Number],default:null},replyForm:{type:Object,default:()=>({actor_id:null,content:"",content_warning:""})},sendingReply:{type:Boolean,default:!1}},computed:{paginationRange(){const n=[],e=this.pagination.page-2,s=this.pagination.page+2+1;for(let r=1;r<=this.pagination.lastPage;r++)(r===1||r===this.pagination.lastPage||r>=e&&r<s)&&n.push(r);const o=[];let a;for(let r of n)a&&(r-a===2?o.push(a+1):r-a!==1&&o.push("...")),o.push(r),a=r;return o}}};var nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-0"},[e("div",{staticClass:"flex flex-col"},[!t.loading&&t.notes.length===0?e("div",{staticClass:"py-8 text-center text-gray-400"},[t._v(" Inbox is empty. ")]):t._e(),e("div",{staticClass:"flex flex-col divide-y"},t._l(t.notes,function(s){return e("inbox-note",{key:s.id,attrs:{note:s,permissions:t.permissions},on:{reply:function(o){return t.$emit("reply",o)},boost:function(o){return t.$emit("boost",o)},quote:function(o){return t.$emit("quote",o)},like:function(o){return t.$emit("like",o)},history:function(o){return t.$emit("history",o)},thread:function(o){return t.$emit("thread",o)},json:function(o){return t.$emit("json",o)},lightbox:function(o){return t.$emit("lightbox",o)},delete:function(o){return t.$emit("delete",o)},edit:function(o){return t.$emit("edit",o)},vote:function(o){return t.$emit("vote",o)}},scopedSlots:t._u([{key:"reply-editor",fn:function(){return[t.activeReplyId===s.id?e("inbox-reply-form",{attrs:{actors:t.actors,"actor-id":t.replyForm.actor_id,content:t.replyForm.content,"content-warning":t.replyForm.content_warning,loading:t.sendingReply},on:{"update:actorId":function(o){return t.$emit("update:replyForm",{...t.replyForm,actor_id:o})},"update:content":function(o){return t.$emit("update:replyForm",{...t.replyForm,content:o})},"update:contentWarning":function(o){return t.$emit("update:replyForm",{...t.replyForm,content_warning:o})},cancel:function(o){return t.$emit("update:activeReplyId",null)},submit:function(o){return t.$emit("submit-reply",s)}}}):t._e()]},proxy:!0}],null,!0)})}),1),t.pagination.total>0?e("div",{staticClass:"py-6 px-4 sm:px-6 flex items-center justify-between"},[e("div",{staticClass:"text-sm text-gray-500"},[t._v(" Showing "+t._s((t.pagination.page-1)*t.pagination.perPage+1)+" to "+t._s(Math.min(t.pagination.page*t.pagination.perPage,t.pagination.total))+" of "+t._s(t.pagination.total)+" entries ")]),e("div",{staticClass:"flex gap-1 items-center"},[e("select",{staticClass:"btn btn-sm pr-8 mr-2",domProps:{value:t.pagination.perPage},on:{change:function(s){t.$emit("per-page-change",parseInt(s.target.value))}}},[e("option",{domProps:{value:25}},[t._v("25 / page")]),e("option",{domProps:{value:50}},[t._v("50 / page")]),e("option",{domProps:{value:100}},[t._v("100 / page")])]),e("button",{staticClass:"btn btn-sm",attrs:{disabled:t.pagination.page<=1||t.loading},on:{click:function(s){return t.$emit("page-change",t.pagination.page-1)}}},[t._v("←")]),t._l(t.paginationRange,function(s,o){return[s==="..."?e("span",{key:"dots"+o,staticClass:"px-2 py-1 text-gray-400"},[t._v("...")]):e("button",{key:s,staticClass:"btn btn-sm",class:{"bg-blue-600 border-blue-600 font-bold":s===t.pagination.page},attrs:{disabled:t.loading},on:{click:function(a){return t.$emit("page-change",s)}}},[t._v(" "+t._s(s)+" ")])]}),e("button",{staticClass:"btn btn-sm",attrs:{disabled:t.pagination.page>=t.pagination.lastPage||t.loading},on:{click:function(s){return t.$emit("page-change",t.pagination.page+1)}}},[t._v("→")])],2)]):t._e(),t.loading?e("div",{staticClass:"py-12 text-center text-gray-500"},[e("svg",{staticClass:"animate-spin h-8 w-8 mx-auto text-gray-400 mb-3",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"}},[e("circle",{staticClass:"opacity-25",attrs:{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}}),e("path",{staticClass:"opacity-75",attrs:{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}})]),e("span",[t._v("Loading...")])]):t._e()])])},ot=[],at=i(st,nt,ot,!1,null,null);const _=at.exports,rt={components:{InboxStack:u},props:{open:{type:Boolean,required:!0},form:{type:Object,required:!0},actors:{type:Array,default:()=>[]},isEditing:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},previewUrl:{type:String,default:null}}};var it=function(){var t=this,e=t._self._c;return e("inbox-stack",{attrs:{open:t.open,title:t.isEditing?"Edit Note":"Create Note"},on:{closed:function(s){return t.$emit("close")}},scopedSlots:t._u([{key:"footer-end",fn:function(){return[e("button",{staticClass:"btn",on:{click:function(s){return t.$emit("close")}}},[t._v("Cancel")]),e("button",{staticClass:"btn-primary",attrs:{disabled:t.loading},on:{click:function(s){return t.$emit("submit")}}},[t._v(" "+t._s(t.loading?"Saving...":t.isEditing?"Update":"Create")+" ")])]},proxy:!0}])},[e("div",{staticClass:"mb-5"},[e("label",{staticClass:"block text-sm font-bold mb-2"},[t._v("Post As")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.actor,expression:"form.actor"}],staticClass:"input-text w-full",attrs:{disabled:t.isEditing},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(a){return a.selected}).map(function(a){var r="_value"in a?a._value:a.value;return r});t.$set(t.form,"actor",s.target.multiple?o:o[0])}}},t._l(t.actors,function(s){return e("option",{key:s.id,domProps:{value:s.id}},[t._v(t._s(s.name)+" ("+t._s(s.handle)+")")])}),0)]),e("div",{staticClass:"mb-5 flex flex-col"},[e("label",{staticClass:"block text-sm font-bold mb-2"},[t._v("Content")]),e("div",{staticClass:"mb-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.content_warning,expression:"form.content_warning"}],staticClass:"input-text w-full",attrs:{type:"text",placeholder:"Content Warning (optional)"},domProps:{value:t.form.content_warning},on:{input:function(s){s.target.composing||t.$set(t.form,"content_warning",s.target.value)}}})]),e("div",{staticClass:"min-h-[200px]"},[e("markdown-fieldtype",{attrs:{value:t.form.content,"model-value":t.form.content,config:{cheatsheet:!0,container:"assets",buttons:["bold","italic","unorderedlist","orderedlist","quote","link","image","table"],type:"markdown"},meta:{previewUrl:t.previewUrl}},on:{input:s=>t.form.content=s,"update:modelValue":s=>t.form.content=s,"update:value":s=>t.form.content=s}})],1)])])},lt=[],ct=i(rt,it,lt,!1,null,null);const dt=ct.exports,ut={components:{InboxStack:u},props:{open:{type:Boolean,required:!0},form:{type:Object,required:!0},actors:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},methods:{addOption(){this.form.options.push("")},removeOption(n){this.form.options.splice(n,1)}}};var pt=function(){var t=this,e=t._self._c;return e("inbox-stack",{attrs:{open:t.open,title:"Create Poll"},on:{closed:function(s){return t.$emit("close")}},scopedSlots:t._u([{key:"footer-end",fn:function(){return[e("button",{staticClass:"btn",on:{click:function(s){return t.$emit("close")}}},[t._v("Cancel")]),e("button",{staticClass:"btn-primary",attrs:{disabled:t.loading},on:{click:function(s){return t.$emit("submit")}}},[t._v(" "+t._s(t.loading?"Creating...":"Create Poll")+" ")])]},proxy:!0}])},[e("div",{staticClass:"mb-5"},[e("label",{staticClass:"block text-sm font-bold mb-2"},[t._v("Post As")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.actor,expression:"form.actor"}],staticClass:"input-text w-full",on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(a){return a.selected}).map(function(a){var r="_value"in a?a._value:a.value;return r});t.$set(t.form,"actor",s.target.multiple?o:o[0])}}},t._l(t.actors,function(s){return e("option",{key:s.id,domProps:{value:s.id}},[t._v(t._s(s.name)+" ("+t._s(s.handle)+")")])}),0)]),e("div",{staticClass:"mb-5"},[e("label",{staticClass:"block text-sm font-bold mb-2"},[t._v("Question")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.content,expression:"form.content"}],staticClass:"input-text w-full",attrs:{rows:"3",placeholder:"Ask a question..."},domProps:{value:t.form.content},on:{input:function(s){s.target.composing||t.$set(t.form,"content",s.target.value)}}})]),e("div",{staticClass:"mb-5"},[e("label",{staticClass:"flex items-center space-x-2 cursor-pointer"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.multiple_choice,expression:"form.multiple_choice"}],staticClass:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.multiple_choice)?t._i(t.form.multiple_choice,null)>-1:t.form.multiple_choice},on:{change:function(s){var o=t.form.multiple_choice,a=s.target,r=!!a.checked;if(Array.isArray(o)){var c=null,l=t._i(o,c);a.checked?l<0&&t.$set(t.form,"multiple_choice",o.concat([c])):l>-1&&t.$set(t.form,"multiple_choice",o.slice(0,l).concat(o.slice(l+1)))}else t.$set(t.form,"multiple_choice",r)}}}),e("span",{staticClass:"text-sm font-bold"},[t._v("Allow Multiple Choices (Checkboxes)")])])]),e("div",{staticClass:"mb-5"},[e("label",{staticClass:"block text-sm font-bold mb-2"},[t._v("Options")]),e("div",{staticClass:"text-xs text-gray-500 mb-2"},[t._v("Leave options empty for an open-ended question.")]),e("div",{staticClass:"space-y-2"},t._l(t.form.options,function(s,o){return e("div",{key:o,staticClass:"flex items-center gap-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.options[o],expression:"form.options[idx]"}],staticClass:"input-text w-full text-sm",attrs:{type:"text",placeholder:"Option text"},domProps:{value:t.form.options[o]},on:{input:function(a){a.target.composing||t.$set(t.form.options,o,a.target.value)}}}),t.form.options.length>2?e("button",{staticClass:"text-red-500 hover:text-red-700",on:{click:function(a){return t.removeOption(o)}}},[t._v("×")]):t._e()])}),0),e("button",{staticClass:"mt-2 text-sm text-blue-600 hover:text-blue-800",on:{click:t.addOption}},[t._v("+ Add Option")])])])},mt=[],ft=i(ut,pt,mt,!1,null,null);const gt=ft.exports,ht={components:{InboxStack:u,InboxNote:p},props:{open:{type:Boolean,required:!0},form:{type:Object,required:!0},actors:{type:Array,default:()=>[]},quotedNote:{type:Object,default:null},loading:{type:Boolean,default:!1}}};var vt=function(){var t=this,e=t._self._c;return e("inbox-stack",{attrs:{open:t.open,title:"Quote Post"},on:{closed:function(s){return t.$emit("close")}},scopedSlots:t._u([{key:"footer-end",fn:function(){return[e("button",{staticClass:"btn",on:{click:function(s){return t.$emit("close")}}},[t._v("Cancel")]),e("button",{staticClass:"btn-primary",attrs:{disabled:t.loading},on:{click:function(s){return t.$emit("submit")}}},[t._v(" "+t._s(t.loading?"Posting...":"Quote")+" ")])]},proxy:!0}])},[e("div",{staticClass:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},[e("div",{staticClass:"text-xs text-gray-500 dark:text-gray-400 mb-2"},[t._v("Quoting:")]),t.quotedNote?e("inbox-note",{attrs:{note:t.quotedNote,permissions:{update:!1,delete:!1}},on:{reply:()=>{},boost:()=>{},quote:()=>{},like:()=>{}}}):t._e()],1),e("div",{staticClass:"mb-5"},[e("label",{staticClass:"block text-sm font-bold mb-2"},[t._v("Post As")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.actor,expression:"form.actor"}],staticClass:"input-text w-full",on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(a){return a.selected}).map(function(a){var r="_value"in a?a._value:a.value;return r});t.$set(t.form,"actor",s.target.multiple?o:o[0])}}},t._l(t.actors,function(s){return e("option",{key:s.id,domProps:{value:s.id}},[t._v(" "+t._s(s.name)+" ("+t._s(s.handle)+") ")])}),0)]),e("div",{staticClass:"mb-5"},[e("label",{staticClass:"block text-sm font-bold mb-2"},[t._v("Content Warning (Optional)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.content_warning,expression:"form.content_warning"}],staticClass:"input-text w-full",attrs:{type:"text",placeholder:"Content Warning (optional)"},domProps:{value:t.form.content_warning},on:{input:function(s){s.target.composing||t.$set(t.form,"content_warning",s.target.value)}}})]),e("div",{staticClass:"mb-5"},[e("label",{staticClass:"block text-sm font-bold mb-2"},[t._v("Your Commentary")]),e("markdown-fieldtype",{attrs:{value:t.form.content,"model-value":t.form.content,config:{cheatsheet:!0,container:"assets",buttons:["bold","italic","unorderedlist","orderedlist","quote","link","image","table"],type:"markdown"}},on:{input:s=>t.form.content=s,"update:modelValue":s=>t.form.content=s,"update:value":s=>t.form.content=s}})],1)])},_t=[],bt=i(ht,vt,_t,!1,null,null);const yt=bt.exports,xt={components:{InboxNote:p,InboxStack:u,InboxJsonStack:I,InboxHistoryStack:U,InboxThreadStack:v,InboxThreadStack:v,InboxTitle:et,InboxFeed:_,InboxFeed:_,InboxNoteForm:dt,InboxPollForm:gt,InboxQuoteForm:yt,InboxReplyForm:g},props:{initialActors:{type:Array,default:()=>[]},apiUrl:{type:String,required:!0},replyUrl:{type:String,required:!0},likeUrl:{type:String,required:!0},unlikeUrl:{type:String,required:!0},announceUrl:{type:String,required:!0},undoAnnounceUrl:{type:String,required:!0},createNoteUrl:{type:String,default:null},storeNoteUrl:{type:String,default:null},storePollUrl:{type:String,default:null},deleteUrl:{type:String,default:null},updateNoteUrl:{type:String,default:null},linkPreviewUrl:{type:String,default:null},markdownPreviewUrl:{type:String,default:null},batchLinkPreviewUrl:{type:String,default:null}},data(){return{notes:[],page:1,lastPage:1,total:0,perPage:parseInt(localStorage.getItem("activitypub_per_page"))||25,loading:!1,filter:"all",error:null,localActors:this.initialActors,activeReplyId:null,replyForm:{content:"",content_warning:"",actor_id:this.initialActors[0]?.id||null},sendingReply:!1,lightbox:{open:!1,images:[],index:0},jsonModal:{open:!1,content:""},isCreatingNote:!1,newNote:{content:"",content_warning:"",actor:null},isCreatingPoll:!1,newPoll:{actor:null,content:"",multiple_choice:!1,options:["",""]},isCreatingQuote:!1,quotedNote:null,newQuote:{actor:null,content:"",content_warning:"",quote_of:null},showNewDropdown:!1,creating:!1,editingNoteId:null,isViewingHistory:!1,historyNote:null,isViewingThread:!1,threadNote:null}},mounted(){document.title="Inbox ‹ ActivityPub ‹ Statamic",this.loadNotes()},methods:{updateReplyForm(n){this.replyForm=n},loadNotes(){this.loading||(this.loading=!0,this.error=null,this.$axios.get(this.apiUrl,{params:{page:this.page,per_page:this.perPage,filter:this.filter}}).then(n=>{const t=n.data,e=t.data.map(o=>({...o,showContent:!o.sensitive}));this.notes=e,this.total=t.meta.total,this.lastPage=t.meta.last_page;const s=e.filter(o=>o.needs_preview&&!o.link_preview&&!o.oembed).map(o=>o.id);s.length>0&&this.batchLinkPreviewUrl&&this.fetchBatchPreviews(s)}).catch(n=>{this.error=n.response&&n.response.data.message?n.response.data.message:n.message||"Unknown error"}).finally(()=>{this.loading=!1}))},fetchBatchPreviews(n){this.$axios.post(this.batchLinkPreviewUrl,{note_ids:n}).then(t=>{const e=t.data;this.notes=this.notes.map(s=>e[s.id]?{...s,link_preview:e[s.id]}:s)}).catch(console.error)},changePage(n){n<1||n>this.lastPage||(this.page=n,this.loadNotes(),this.$nextTick(()=>window.scrollTo({top:0,behavior:"smooth"})))},changePerPage(n){this.perPage=n,this.page=1,localStorage.setItem("activitypub_per_page",n),this.loadNotes(),this.$nextTick(()=>window.scrollTo({top:0,behavior:"smooth"}))},setFilter(n){this.filter=n,this.page=1,this.loadNotes()},retry(){this.loadNotes()},toggleNewDropdown(){this.showNewDropdown=!this.showNewDropdown},createNote(){this.isCreatingNote=!0,this.editingNoteId=null,this.newNote={content:"",content_warning:"",actor:this.localActors[0]?.id||null}},editNote(n){this.isCreatingNote=!0,this.editingNoteId=n.id,this.newNote={content:n.content_raw||n.content,content_warning:n.summary||"",actor:n.actor.id}},closeNoteModal(){this.isCreatingNote=!1,this.editingNoteId=null},submitNote(){if(this.creating)return;const n=this.editingNoteId?this.updateNoteUrl.replace("ID",this.editingNoteId):this.storeNoteUrl,t=this.editingNoteId?"PUT":"POST";this.newNote.content.trim()&&(this.creating=!0,this.creating=!0,this.$axios[t.toLowerCase()](n,this.newNote).then(()=>{this.closeNoteModal(),this.loadNotes()}).catch(e=>{const s=e.response&&e.response.data.message?e.response.data.message:e.message;alert(s)}).finally(()=>{this.creating=!1}))},createPollAndClose(){this.showNewDropdown=!1,this.isCreatingPoll=!0,this.newPoll={actor:this.localActors[0]?.id||null,content:"",multiple_choice:!1,options:["",""]}},closePollModal(){this.isCreatingPoll=!1},addOption(){this.newPoll.options.push("")},removeOption(n){this.newPoll.options.splice(n,1)},submitPoll(){if(this.creating||!this.newPoll.content.trim())return;const n=this.newPoll.options.filter(t=>t.trim());if(n.length<2&&n.length>0){alert("A poll needs at least 2 options, or none for open-ended.");return}this.creating=!0,this.creating=!0,this.$axios.post(this.storePollUrl,{actor:this.newPoll.actor,content:this.newPoll.content,options:n,multiple_choice:this.newPoll.multiple_choice}).then(()=>{this.closePollModal(),this.loadNotes()}).catch(t=>{const e=t.response&&t.response.data.message?t.response.data.message:t.message;alert(e)}).finally(()=>this.creating=!1)},toggleReply(n){this.activeReplyId===n.id?this.activeReplyId=null:(this.activeReplyId=n.id,this.replyForm={content:"",content_warning:"",actor_id:this.localActors[0]?.id||null})},submitReply(n){this.sendingReply||this.replyForm.content.trim()&&(this.sendingReply=!0,this.sendingReply=!0,this.$axios.post(this.replyUrl,{in_reply_to:n.id,content:this.replyForm.content,content_warning:this.replyForm.content_warning,actor:this.replyForm.actor_id}).then(()=>{this.activeReplyId=null,this.loadNotes()}).catch(t=>{const e=t.response&&t.response.data.message?t.response.data.message:t.message;alert(e)}).finally(()=>this.sendingReply=!1))},openQuoteModal(n){this.quotedNote=n,this.isCreatingQuote=!0,this.newQuote={actor:this.localActors[0]?.id||null,content:"",content_warning:"",quote_of:n.id}},closeQuoteModal(){this.isCreatingQuote=!1,this.quotedNote=null},submitQuote(){this.creating||(this.creating=!0,this.creating=!0,this.$axios.post(this.storeNoteUrl,this.newQuote).then(()=>{this.closeQuoteModal(),this.loadNotes()}).catch(n=>{const t=n.response&&n.response.data.message?n.response.data.message:n.message;alert(t)}).finally(()=>this.creating=!1))},toggleBoost(n){const t=n.boosted_by_user,e=t?this.undoAnnounceUrl:this.announceUrl;this.$axios.post(e,{object:n.id,actor:this.localActors[0].id}).then(s=>{const o=s.data;n.boosted_by_user=!t,o.counts&&(n.counts=o.counts)})},toggleLike(n){const t=n.liked_by_user,e=t?this.unlikeUrl:this.likeUrl;this.$axios.post(e,{object:n.id,actor:this.localActors[0].id}).then(s=>{const o=s.data;n.liked_by_user=!t,o.counts?n.counts=o.counts:n.counts.likes=(n.counts.likes||0)+(t?-1:1)})},handleVote(n){const{note:t,option:e,callback:s}=n;this.$axios.post(this.storeNoteUrl+"/vote",{poll:t.id,choices:[e.name],actor:this.localActors[0].id}).then(o=>{s(!0)}).catch(()=>s(!1))},deleteItem(n){confirm("Are you sure you want to delete this note?")&&this.$axios.delete(this.deleteUrl,{data:{id:n.id}}).then(()=>{this.notes=this.notes.filter(t=>t.id!==n.id)})},openLightbox(n,t){this.lightbox.images=n,this.lightbox.index=t,this.lightbox.open=!0},closeLightbox(){this.lightbox.open=!1},lightboxNav(n){let t=this.lightbox.index+n;t<0&&(t=this.lightbox.images.length-1),t>=this.lightbox.images.length&&(t=0),this.lightbox.index=t},viewJson(n){this.jsonModal.content=n.activitypub_json||n,this.jsonModal.open=!0},closeJsonModal(){this.jsonModal.open=!1},viewHistory(n){this.isViewingHistory=!0,this.historyNote=n},closeHistoryModal(){this.isViewingHistory=!1,this.historyNote=null},viewThread(n){this.isViewingThread=!0,this.threadNote=n},closeThreadModal(){this.isViewingThread=!1,this.isViewingThread=!1,this.threadNote=null}}};var wt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"max-w-3xl mx-auto"},[e("inbox-title",{attrs:{"current-filter":t.filter,"can-create-note":!!t.createNoteUrl,"show-new-dropdown":t.showNewDropdown},on:{"filter-change":t.setFilter,"create-note":t.createNote,"toggle-dropdown":t.toggleNewDropdown,"create-poll":t.createPollAndClose}}),e("inbox-feed",{attrs:{notes:t.notes,loading:t.loading,pagination:{page:t.page,lastPage:t.lastPage,total:t.total,perPage:t.perPage},permissions:{update:!!t.updateNoteUrl,delete:!!t.deleteUrl},actors:t.localActors,"active-reply-id":t.activeReplyId,"reply-form":t.replyForm,"sending-reply":t.sendingReply},on:{"page-change":t.changePage,"per-page-change":t.changePerPage,"update:activeReplyId":function(s){t.activeReplyId=s},"update:replyForm":t.updateReplyForm,"submit-reply":t.submitReply,reply:t.toggleReply,boost:t.toggleBoost,quote:t.openQuoteModal,like:t.toggleLike,history:t.viewHistory,thread:t.viewThread,json:t.viewJson,lightbox:s=>t.openLightbox(s.attachments,s.index),delete:t.deleteItem,edit:t.editNote,vote:t.handleVote}}),t.lightbox.open?e("div",{staticClass:"fixed inset-0 z-[9999] bg-black/90 flex flex-col items-center justify-center",on:{click:function(s){return s.target!==s.currentTarget?null:t.closeLightbox.apply(null,arguments)}}},[e("button",{staticClass:"absolute top-4 right-4 text-white text-3xl",on:{click:t.closeLightbox}},[t._v("×")]),e("button",{staticClass:"absolute left-8 text-white text-3xl p-4 bg-white/10 rounded-full hover:bg-white/20",on:{click:function(s){return t.lightboxNav(-1)}}},[t._v("‹")]),e("button",{staticClass:"absolute right-8 text-white text-3xl p-4 bg-white/10 rounded-full hover:bg-white/20",on:{click:function(s){return t.lightboxNav(1)}}},[t._v("›")]),e("img",{staticClass:"max-w-[90vw] max-h-[85vh] object-contain",attrs:{src:t.lightbox.images[t.lightbox.index].url}}),e("div",{staticClass:"text-white mt-4"},[t._v(t._s(t.lightbox.images[t.lightbox.index].description))])]):t._e(),e("inbox-json-stack",{attrs:{open:t.jsonModal.open,content:t.jsonModal.content},on:{close:t.closeJsonModal}}),e("inbox-note-form",{attrs:{open:t.isCreatingNote,form:t.newNote,actors:t.localActors,"is-editing":!!t.editingNoteId,loading:t.creating,"preview-url":t.markdownPreviewUrl},on:{close:t.closeNoteModal,submit:t.submitNote}}),e("inbox-poll-form",{attrs:{open:t.isCreatingPoll,form:t.newPoll,actors:t.localActors,loading:t.creating},on:{close:t.closePollModal,submit:t.submitPoll}}),e("inbox-quote-form",{attrs:{open:t.isCreatingQuote,form:t.newQuote,actors:t.localActors,"quoted-note":t.quotedNote,loading:t.creating},on:{close:t.closeQuoteModal,submit:t.submitQuote}}),e("inbox-history-stack",{attrs:{open:t.isViewingHistory,"note-id":t.historyNote?t.historyNote.id:null,"api-url":t.apiUrl},on:{close:t.closeHistoryModal,"view-json":t.viewJson}}),e("inbox-thread-stack",{attrs:{open:t.isViewingThread,"note-id":t.threadNote?t.threadNote.id:null,"api-url":t.apiUrl,"active-reply-id":t.activeReplyId,"reply-form":t.replyForm,"sending-reply":t.sendingReply,actors:t.localActors,permissions:{update:!!t.updateNoteUrl,delete:!!t.deleteUrl}},on:{close:t.closeThreadModal,"update:activeReplyId":function(s){t.activeReplyId=s},"update:replyForm":t.updateReplyForm,"submit-reply":t.submitReply,reply:t.toggleReply,boost:t.toggleBoost,like:t.toggleLike,history:t.viewHistory,thread:t.viewThread,json:t.viewJson,lightbox:s=>t.openLightbox(s.attachments,s.index),delete:t.deleteItem,edit:t.editNote}})],1)},kt=[],Ct=i(xt,wt,kt,!1,null,null);const $t=Ct.exports,jt={props:{activities:{type:Array,required:!0},pagination:{type:String,default:""}},data(){return{activityData:this.activities,drawer:{open:!1,visible:!1,uuid:"",content:""}}},methods:{showJson(n){const t=this.activityData.find(e=>e.id===n);!t||!t.json||(this.drawer.uuid=n,this.drawer.content=JSON.stringify(t.json,null,2),this.drawer.open=!0,document.body.style.overflow="hidden",setTimeout(()=>{this.drawer.visible=!0},10))},closeJson(){this.drawer.visible=!1,setTimeout(()=>{this.drawer.open=!1,document.body.style.overflow=""},300)}}};var Nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-0 overflow-hidden"},[e("div",{staticClass:"flex flex-col divide-y divide-gray-100 dark:divide-gray-800"},t._l(t.activityData,function(s){return e("div",{key:s.id,staticClass:"p-4 flex gap-4 hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors group"},[e("div",{staticClass:"flex-shrink-0 pt-1"},[s.avatar?e("img",{staticClass:"w-10 h-10 rounded-full object-cover bg-gray-200 dark:bg-gray-700",attrs:{src:s.avatar}}):e("div",{staticClass:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-400 font-bold text-sm"},[t._v(" "+t._s(s.actorName.charAt(0))+" ")])]),e("div",{staticClass:"flex-1 min-w-0"},[e("div",{staticClass:"flex items-center justify-between"},[e("div",{staticClass:"flex items-center gap-1 min-w-0"},[e("span",{staticClass:"font-bold text-gray-900 dark:text-gray-100 truncate text-sm"},[t._v(t._s(s.actorName))]),e("span",{staticClass:"text-gray-500 text-sm truncate",attrs:{title:s.actorHandle}},[t._v(t._s(s.actorHandle))]),e("span",{staticClass:"text-gray-400 text-xs"},[t._v("•")]),e("span",{staticClass:"text-gray-400 text-xs whitespace-nowrap"},[t._v(t._s(s.date))])]),e("div",{staticClass:"flex items-center gap-2 opacity-50 group-hover:opacity-100 transition-opacity"},[e("button",{staticClass:"text-gray-400 hover:text-blue-500",attrs:{type:"button",title:"View JSON"},on:{click:function(o){return t.showJson(s.id)}}},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z","clip-rule":"evenodd"}})])])])]),e("div",{staticClass:"mt-1 flex items-start gap-2 text-sm text-gray-700 dark:text-gray-300"},[e("span",{staticClass:"text-gray-400 mt-0.5",domProps:{innerHTML:t._s(s.icon)}}),e("div",{staticClass:"prose prose-sm dark:prose-invert max-w-none leading-snug",domProps:{innerHTML:t._s(s.description)}})])])])}),0),e("div",{staticClass:"p-4 border-t border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-gray-900/50"},[e("div",{staticClass:"pagination-container",domProps:{innerHTML:t._s(t.pagination)}})]),t.drawer.open?e("div",{staticClass:"fixed inset-0 z-[100] z-[99]",on:{keydown:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"esc",27,s.key,["Esc","Escape"])?null:t.closeJson.apply(null,arguments)}}},[e("div",{staticClass:"absolute inset-0 bg-gray-900/50 backdrop-blur-sm transition-opacity",on:{click:t.closeJson}}),e("div",{staticClass:"absolute inset-y-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-900 shadow-xl flex flex-col transform transition-transform duration-300 ease-spring drawer",class:{"translate-x-full":!t.drawer.visible,"translate-x-0":t.drawer.visible}},[e("div",{staticClass:"flex items-center justify-between px-6 py-4 border-b border-gray-100 dark:border-gray-800 shrink-0 bg-white dark:bg-gray-900"},[e("div",{staticClass:"flex flex-col gap-1"},[e("h2",{staticClass:"text-lg font-medium text-gray-900 dark:text-gray-100"},[t._v("Payload Inspector")]),e("span",{staticClass:"text-xs font-mono text-gray-500"},[t._v(t._s(t.drawer.uuid))])]),e("button",{staticClass:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",on:{click:t.closeJson}},[e("svg",{staticClass:"h-5 w-5",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"}})])])]),e("div",{staticClass:"flex-1 overflow-auto bg-gray-50 dark:bg-gray-950 p-6"},[e("div",{staticClass:"bg-white dark:bg-gray-900 rounded-lg shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden"},[e("pre",{staticClass:"p-4 text-xs font-mono leading-relaxed text-gray-800 dark:text-gray-200 overflow-x-auto"},[e("code",{staticClass:"language-json"},[t._v(t._s(t.drawer.content))])])])]),e("div",{staticClass:"px-6 py-4 border-t border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-gray-900 shrink-0 flex justify-end"},[e("button",{staticClass:"btn",on:{click:t.closeJson}},[t._v("Close")])])])]):t._e()])},St=[],Pt=i(jt,Nt,St,!1,null,"5bd1ae8c");const At=Pt.exports,Ft={mixins:[window.__STATAMIC__?.core?.FieldtypeMixin||{}],props:{modelValue:{default:void 0}},data(){return{selected:this.modelValue!==void 0?this.modelValue:this.value}},watch:{value(n){this.selected=n},modelValue(n){this.selected=n},selected(n){this.update(n),this.$emit("update:modelValue",n)}}};var Mt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"actor-selector-wrapper"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"input-text w-full",on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(a){return a.selected}).map(function(a){var r="_value"in a?a._value:a.value;return r});t.selected=s.target.multiple?o:o[0]}}},[!t.meta.actors||t.meta.actors.length===0?e("option",{attrs:{disabled:"",value:""}},[t._v(t._s(t.__("No actors found")))]):t._e(),t._l(t.meta.actors,function(s){return e("option",{key:s.value,domProps:{value:s.value}},[t._v(t._s(s.label))])})],2)])},It=[],Rt=i(Ft,Mt,It,!1,null,null);const qt=Rt.exports,Bt={props:{saving:Boolean,success:Boolean,error:String}};var Ot=function(){var t=this,e=t._self._c;return e("header",{staticClass:"mb-6 flex items-center justify-between"},[e("h1",{staticClass:"font-bold text-2xl"},[t._v("ActivityPub Settings")]),e("div",{staticClass:"flex items-center gap-2"},[t.success?e("span",{staticClass:"text-green-600 text-sm font-medium animate-pulse"},[t._v("Saved")]):t._e(),t.error?e("p",{staticClass:"text-red-500 text-sm"},[t._v(t._s(t.error))]):t._e(),e("button",{staticClass:"btn-primary",attrs:{type:"button",disabled:t.saving},on:{click:function(s){return t.$emit("save")}}},[t._v(" "+t._s(t.saving?"Saving...":"Save Settings")+" ")])])])},Ut=[],Ht=i(Bt,Ot,Ut,!1,null,null);const zt=Ht.exports,Tt={props:{title:String,description:String}};var Vt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-0 h-full"},[t.$slots.header||t.title?e("div",{staticClass:"p-4 border-b dark:border-dark-800"},[t.title?e("h2",{staticClass:"font-bold text-lg"},[t._v(t._s(t.title))]):t._e(),t.description?e("p",{staticClass:"text-sm text-gray-500 mt-1"},[t._v(t._s(t.description))]):t._e(),t._t("header")],2):t._e(),e("div",{staticClass:"p-4 space-y-4"},[t._t("default")],2),t.$slots.footer?e("div",{staticClass:"p-4 bg-gray-50 dark:bg-dark-600 border-t dark:border-dark-800"},[t._t("footer")],2):t._e()])},Lt=[],Dt=i(Tt,Vt,Lt,!1,null,null);const m=Dt.exports,Et={components:{SettingsPanel:m},props:{form:Object,collections:Array,taxonomies:Array,types:Object}};var Qt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col gap-6"},[e("settings-panel",{attrs:{title:"General Behavior",description:"Configure global ActivityPub behavior."}},[e("div",{staticClass:"flex flex-col sm:flex-row sm:items-center justify-between gap-4"},[e("div",[e("label",{staticClass:"font-bold text-sm"},[t._v("Allow Quotes")]),e("p",{staticClass:"text-sm text-gray-500"},[t._v('Allow others to quote/boost your activities. Adds "canQuote" permission.')])]),e("div",{staticClass:"toggle-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.form.allow_quotes},on:{change:function(s){return t.$emit("update:allow_quotes",s.target.checked)}}})])])]),e("settings-panel",{attrs:{title:"Collections",description:"Select which content collections to publish."},scopedSlots:t._u([{key:"table",fn:function(){return[e("table",{staticClass:"data-table"},[e("thead",[e("tr",[e("th",[t._v("Collection")]),e("th",[t._v("ActivityPub Type")]),e("th",[t._v("Publish")]),e("th",[t._v("Federate")])])]),e("tbody",t._l(t.collections,function(s){return e("tr",{key:s.handle},[e("td",{staticClass:"p-3"},[e("div",{staticClass:"flex items-center gap-2"},[s.icon?e("div",{staticClass:"w-4 h-4",domProps:{innerHTML:t._s(s.icon)}}):t._e(),e("span",[t._v(t._s(s.title))])])]),e("td",{staticClass:"p-3"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.types[s.handle],expression:"form.types[col.handle]"}],staticClass:"input-text text-sm w-full",on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(r){return r.selected}).map(function(r){var c="_value"in r?r._value:r.value;return c});t.$set(t.form.types,s.handle,o.target.multiple?a:a[0])}}},t._l(t.types,function(o,a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(o))])}),0)]),e("td",{staticClass:"p-3 text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.collections[s.handle],expression:"form.collections[col.handle]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.collections[s.handle])?t._i(t.form.collections[s.handle],null)>-1:t.form.collections[s.handle]},on:{change:function(o){var a=t.form.collections[s.handle],r=o.target,c=!!r.checked;if(Array.isArray(a)){var l=null,d=t._i(a,l);r.checked?d<0&&t.$set(t.form.collections,s.handle,a.concat([l])):d>-1&&t.$set(t.form.collections,s.handle,a.slice(0,d).concat(a.slice(d+1)))}else t.$set(t.form.collections,s.handle,c)}}})]),e("td",{staticClass:"p-3 text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.federated[s.handle],expression:"form.federated[col.handle]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.federated[s.handle])?t._i(t.form.federated[s.handle],null)>-1:t.form.federated[s.handle]},on:{change:function(o){var a=t.form.federated[s.handle],r=o.target,c=!!r.checked;if(Array.isArray(a)){var l=null,d=t._i(a,l);r.checked?d<0&&t.$set(t.form.federated,s.handle,a.concat([l])):d>-1&&t.$set(t.form.federated,s.handle,a.slice(0,d).concat(a.slice(d+1)))}else t.$set(t.form.federated,s.handle,c)}}})])])}),0)])]},proxy:!0}])}),e("settings-panel",{attrs:{title:"Taxonomies"},scopedSlots:t._u([{key:"table",fn:function(){return[e("table",{staticClass:"data-table"},[e("thead",[e("tr",[e("th",[t._v("Taxonomy")]),e("th",[t._v("ActivityPub Type")]),e("th",[t._v("Publish")])])]),e("tbody",{staticClass:"divide-y dark:divide-dark-800"},t._l(t.taxonomies,function(s){return e("tr",{key:s.handle},[e("td",{staticClass:"p-3"},[e("div",{staticClass:"flex items-center gap-2"},[e("svg",{staticClass:"w-4 h-4 text-gray-500",attrs:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"}})]),e("span",[t._v(t._s(s.title))])])]),e("td",{staticClass:"p-3"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.types[s.handle],expression:"form.types[tax.handle]"}],staticClass:"input-text text-sm w-full",on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(r){return r.selected}).map(function(r){var c="_value"in r?r._value:r.value;return c});t.$set(t.form.types,s.handle,o.target.multiple?a:a[0])}}},t._l(t.types,function(o,a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(o))])}),0)]),e("td",{staticClass:"p-3 text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.collections[s.handle],expression:"form.collections[tax.handle]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.form.collections[s.handle])?t._i(t.form.collections[s.handle],null)>-1:t.form.collections[s.handle]},on:{change:function(o){var a=t.form.collections[s.handle],r=o.target,c=!!r.checked;if(Array.isArray(a)){var l=null,d=t._i(a,l);r.checked?d<0&&t.$set(t.form.collections,s.handle,a.concat([l])):d>-1&&t.$set(t.form.collections,s.handle,a.slice(0,d).concat(a.slice(d+1)))}else t.$set(t.form.collections,s.handle,c)}}})])])}),0)])]},proxy:!0}])})],1)},Jt=[],Wt=i(Et,Qt,Jt,!1,null,null);const Zt=Wt.exports,Gt={components:{SettingsPanel:m},props:{form:Object}};var Kt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col gap-6"},[e("settings-panel",{attrs:{title:"Inbox / Outbox Processing",description:"Configure batch sizes and schedule frequency."}},[e("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",[e("label",{staticClass:"font-bold text-sm block mb-1"},[t._v("Inbox Batch Size")]),e("p",{staticClass:"text-xs text-gray-500 mb-2"},[t._v("Items to process per run.")]),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.inbox_batch_size,expression:"form.inbox_batch_size",modifiers:{number:!0}}],staticClass:"input-text w-full",attrs:{type:"number",min:"1"},domProps:{value:t.form.inbox_batch_size},on:{input:function(s){s.target.composing||t.$set(t.form,"inbox_batch_size",t._n(s.target.value))},blur:function(s){return t.$forceUpdate()}}})]),e("div",[e("label",{staticClass:"font-bold text-sm block mb-1"},[t._v("Outbox Batch Size")]),e("p",{staticClass:"text-xs text-gray-500 mb-2"},[t._v("Items to send per run.")]),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.outbox_batch_size,expression:"form.outbox_batch_size",modifiers:{number:!0}}],staticClass:"input-text w-full",attrs:{type:"number",min:"1"},domProps:{value:t.form.outbox_batch_size},on:{input:function(s){s.target.composing||t.$set(t.form,"outbox_batch_size",t._n(s.target.value))},blur:function(s){return t.$forceUpdate()}}})])]),e("div",{staticClass:"border-t dark:border-dark-800 pt-4"},[e("label",{staticClass:"font-bold text-sm block mb-1"},[t._v("Schedule Interval (minutes)")]),e("p",{staticClass:"text-xs text-gray-500 mb-2"},[t._v("How often the scheduled job executes (default: 1 min).")]),e("div",{staticClass:"flex items-center gap-4"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.schedule_interval,expression:"form.schedule_interval",modifiers:{number:!0}}],staticClass:"w-full max-w-sm h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700",attrs:{type:"range",min:"1",max:"60"},domProps:{value:t.form.schedule_interval},on:{__r:function(s){t.$set(t.form,"schedule_interval",t._n(s.target.value))},blur:function(s){return t.$forceUpdate()}}}),e("span",{staticClass:"font-mono bg-gray-100 dark:bg-dark-600 px-2 py-1 rounded text-sm w-12 text-center"},[t._v(t._s(t.form.schedule_interval)+"m")])])])])],1)},Xt=[],Yt=i(Gt,Kt,Xt,!1,null,null);const te=Yt.exports,ee={components:{SettingsPanel:m},props:{form:Object,logsUrl:String}};var se=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col gap-6"},[e("settings-panel",{attrs:{title:"Automatic Cleanup",description:"Manage data retention policies."}},[e("div",[e("label",{staticClass:"font-bold text-sm block mb-1"},[t._v("Maintenance Time")]),e("p",{staticClass:"text-xs text-gray-500 mb-2"},[t._v("Daily run time (24h format).")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.maintenance_time,expression:"form.maintenance_time"}],staticClass:"input-text max-w-xs",attrs:{type:"time"},domProps:{value:t.form.maintenance_time},on:{input:function(s){s.target.composing||t.$set(t.form,"maintenance_time",s.target.value)}}})]),e("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t dark:border-dark-800"},[e("div",[e("label",{staticClass:"font-bold text-sm block mb-1"},[t._v("Clean Activities (Days)")]),e("p",{staticClass:"text-xs text-gray-500 mb-2"},[t._v("Keep external activities (Likes, Announces) for X days.")]),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.retention_activities,expression:"form.retention_activities",modifiers:{number:!0}}],staticClass:"input-text w-full",attrs:{type:"number",min:"0"},domProps:{value:t.form.retention_activities},on:{input:function(s){s.target.composing||t.$set(t.form,"retention_activities",t._n(s.target.value))},blur:function(s){return t.$forceUpdate()}}})]),e("div",[e("label",{staticClass:"font-bold text-sm block mb-1"},[t._v("Clean Objects (Days)")]),e("p",{staticClass:"text-xs text-gray-500 mb-2"},[t._v("Keep external objects (Notes, Articles) for X days.")]),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.retention_entries,expression:"form.retention_entries",modifiers:{number:!0}}],staticClass:"input-text w-full",attrs:{type:"number",min:"0"},domProps:{value:t.form.retention_entries},on:{input:function(s){s.target.composing||t.$set(t.form,"retention_entries",t._n(s.target.value))},blur:function(s){return t.$forceUpdate()}}})])])]),e("settings-panel",{attrs:{title:"Activity Logs",description:"View detailed logs for inbox and outbox processing."}},[e("div",{staticClass:"flex items-center justify-between"},[e("div",[e("p",{staticClass:"text-sm text-gray-500"},[t._v("Useful for debugging connection issues.")])]),e("a",{staticClass:"btn",attrs:{href:t.logsUrl}},[t._v("View Logs")])])])],1)},ne=[],oe=i(ee,se,ne,!1,null,null);const ae=oe.exports,re={components:{SettingsPanel:m},props:{form:Object}};var ie=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col gap-6"},[e("settings-panel",{attrs:{title:"Domain Blocklist",description:"Prevent interactions with specific domains."}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.blocklist,expression:"form.blocklist"}],staticClass:"input-text w-full h-64 font-mono text-sm",attrs:{placeholder:"example.com\\nspam.server.social",rows:"25"},domProps:{value:t.form.blocklist},on:{input:function(s){s.target.composing||t.$set(t.form,"blocklist",s.target.value)}}}),e("p",{staticClass:"text-xs text-gray-500 mt-2"},[t._v(" One domain per line. Subdomains are automatically blocked if the parent is listed. See "),e("a",{staticClass:"text-blue-500 hover:underline",attrs:{href:"https://github.com/gardenfence/blocklist/blob/main/gardenfence.txt",target:"_blank"}},[t._v("GardenFence")]),t._v(" for a starter list. ")])])],1)},le=[],ce=i(re,ie,le,!1,null,null);const de=ce.exports,ue={components:{SettingsTitle:zt,SettingsContent:Zt,SettingsScheduling:te,SettingsMaintenance:ae,SettingsBlocklist:de},props:{initialSettings:{type:Object,required:!0},collections:{type:Array,default:()=>[]},taxonomies:{type:Array,default:()=>[]},types:{type:Object,default:()=>({})},saveUrl:{type:String,required:!0},logsUrl:{type:String,required:!0}},data(){return{currentTab:"content",tabs:[{id:"content",label:"Content"},{id:"scheduling",label:"Scheduling"},{id:"maintenance",label:"Maintenance"},{id:"blocklist",label:"Blocklist"}],form:{allow_quotes:!1,inbox_batch_size:50,outbox_batch_size:50,schedule_interval:1,maintenance_time:"02:00",retention_activities:2,retention_entries:30,blocklist:"",collections:{},federated:{},types:{}},saving:!1,success:!1,error:null}},created(){try{const n={allow_quotes:this.initialSettings.allow_quotes||!1,inbox_batch_size:this.initialSettings.inbox_batch_size||50,outbox_batch_size:this.initialSettings.outbox_batch_size||50,schedule_interval:this.initialSettings.schedule_interval||1,maintenance_time:this.initialSettings.maintenance_time||"02:00",retention_activities:this.initialSettings.retention_activities||2,retention_entries:this.initialSettings.retention_entries||30,blocklist:this.initialSettings.blocklist||"",collections:{},federated:{},types:{}};this.collections.forEach(t=>{const e=this.initialSettings[t.handle]||{};n.collections[t.handle]=!!e.enabled,n.types[t.handle]=e.type||"Object",n.federated[t.handle]=!!e.federated}),this.taxonomies.forEach(t=>{const e=this.initialSettings[t.handle]||{};n.collections[t.handle]=!!e.enabled,n.types[t.handle]=e.type||"Object"}),this.form=n}catch(n){console.error("Error initializing Settings component:",n),this.error="Failed to load settings: "+n.message}},methods:{save(){this.saving=!0,this.success=!1,this.error=null;const n={collections:this.form.collections,types:this.form.types,federated:this.form.federated,allow_quotes:this.form.allow_quotes?1:0,inbox_batch_size:this.form.inbox_batch_size,outbox_batch_size:this.form.outbox_batch_size,schedule_interval:this.form.schedule_interval,maintenance_time:this.form.maintenance_time,retention_activities:this.form.retention_activities,retention_entries:this.form.retention_entries,blocklist:this.form.blocklist};this.$axios.post(this.saveUrl,n).then(t=>{this.success=!0,setTimeout(()=>{this.success=!1},3e3),Statamic.$toast.success("Settings saved successfully.")}).catch(t=>{console.error(t);const e=t.response?.data?.message||"Failed to save settings.";this.error=e,Statamic.$toast.error(e)}).finally(()=>{this.saving=!1})}}};var pe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"max-w-5xl mx-auto"},[e("settings-title",{attrs:{saving:t.saving,success:t.success,error:t.error},on:{save:t.save}}),e("div",{staticClass:"flex flex-col gap-6"},[e("div",{staticClass:"w-full flex border-b dark:border-dark-800"},t._l(t.tabs,function(s){return e("button",{key:s.id,staticClass:"px-4 py-2 text-sm font-medium border-b-2 transition-colors focus:outline-none",class:t.currentTab===s.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",on:{click:function(o){o.preventDefault(),t.currentTab=s.id}}},[t._v(" "+t._s(s.label)+" ")])}),0),t.currentTab==="content"?e("div",[e("settings-content",{attrs:{form:t.form,collections:t.collections,taxonomies:t.taxonomies,types:t.types},on:{"update:allow_quotes":function(s){t.form.allow_quotes=s}}})],1):t._e(),t.currentTab==="scheduling"?e("div",[e("settings-scheduling",{attrs:{form:t.form}})],1):t._e(),t.currentTab==="maintenance"?e("div",[e("settings-maintenance",{attrs:{form:t.form,"logs-url":t.logsUrl}})],1):t._e(),t.currentTab==="blocklist"?e("div",[e("settings-blocklist",{attrs:{form:t.form}})],1):t._e()])],1)},me=[],fe=i(ue,pe,me,!1,null,null);const ge=fe.exports,he={};var ve=function(){var t=this;return t._self._c,t._m(0)},_e=[function(){var n=this,t=n._self._c;return t("div",{staticClass:"flex items-center justify-between mb-3"},[t("h1",[n._v("Following")])])}],be=i(he,ve,_e,!1,null,null);const ye=be.exports,xe={props:{title:{type:String,required:!0},actors:{type:Array,default:()=>[]},emptyText:{type:String,default:"No actors found."}}};var we=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-0 mb-4"},[e("div",{staticClass:"flex items-center justify-between p-3 border-b"},[e("h2",{staticClass:"font-bold text-lg"},[t._v(t._s(t.title))])]),e("table",{staticClass:"data-table"},[t._m(0),e("tbody",[t.actors.length===0?e("tr",[e("td",{staticClass:"text-gray-500 text-center py-4",attrs:{colspan:"2"}},[t._v(t._s(t.emptyText))])]):t._l(t.actors,function(s){return e("tr",{key:s.id},[e("td",[e("div",{staticClass:"flex items-center gap-2"},[s.avatar?e("img",{staticClass:"w-8 h-8 rounded-full object-cover",attrs:{src:s.avatar}}):e("div",{staticClass:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-xs text-gray-500"},[t._v(" "+t._s(s.title.charAt(0))+" ")]),e("div",[e("div",{staticClass:"font-bold"},[t._v(t._s(s.title))]),e("div",{staticClass:"text-xs text-gray-500"},[t._v(t._s(s.activitypub_id))])])])]),e("td",{staticClass:"text-right"},[e("div",{staticClass:"flex gap-2 justify-end"},[t._t("actions",null,{actor:s})],2)])])})],2)])])},ke=[function(){var n=this,t=n._self._c;return t("thead",[t("tr",[t("th",[n._v("Actor")]),t("th",{staticClass:"text-right"},[n._v("Actions")])])])}],Ce=i(xe,we,ke,!1,null,null);const b=Ce.exports,$e={data(){return{handle:"",loading:!1,error:null,result:null,followLoading:!1,followSuccess:!1}},methods:{search(){this.handle&&(this.loading=!0,this.error=null,this.result=null,this.followSuccess=!1,this.$axios.post("/cp/activitypub/search",{handle:this.handle}).then(n=>{this.result=n.data}).catch(n=>{this.error=n.response?.data?.error||n.message}).finally(()=>{this.loading=!1}))},follow(n){this.followLoading=!0,this.$axios.post("/cp/activitypub/follow",{id:n}).then(t=>{this.followSuccess=!0,this.result.is_pending=!0,setTimeout(()=>{this.$emit("followed")},2e3)}).catch(t=>{Statamic.$toast.error("Follow failed: "+(t.response?.data?.error||t.message))}).finally(()=>{this.followLoading=!1})}}};var je=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-4 mb-4"},[e("h2",{staticClass:"font-bold mb-2"},[t._v("Find People to Follow")]),e("div",{staticClass:"flex gap-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.handle,expression:"handle"}],staticClass:"input-text flex-1",attrs:{type:"text",placeholder:"nick@whoisnick.com"},domProps:{value:t.handle},on:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.search.apply(null,arguments)},input:function(s){s.target.composing||(t.handle=s.target.value)}}}),e("button",{staticClass:"btn-primary",attrs:{disabled:t.loading},on:{click:t.search}},[t._v(" "+t._s(t.loading?"Searching...":"Search")+" ")])]),t.result||t.error||t.loading?e("div",{staticClass:"mt-4"},[t.loading?e("div",{staticClass:"loading loading-basic"},[e("span",{staticClass:"icon icon-circular-graph animation-spin"}),t._v(" Searching... ")]):t.error?e("div",{staticClass:"text-red-500"},[t._v(t._s(t.error))]):t.result?e("div",{staticClass:"flex items-center justify-between border p-3 rounded bg-gray-50 dark:bg-gray-800 dark:border-gray-700"},[e("div",{staticClass:"flex items-center gap-3"},[t.result.avatar?e("img",{staticClass:"w-10 h-10 rounded-full object-cover",attrs:{src:t.result.avatar}}):e("div",{staticClass:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-500 font-bold text-lg"},[t._v(" "+t._s(t.result.name?t.result.name.charAt(0):"?")+" ")]),e("div",[e("div",{staticClass:"font-bold text-lg"},[t._v(t._s(t.result.name))]),e("div",{staticClass:"text-sm text-gray-500 mb-1"},[t._v(t._s(t.result.activitypub_id))]),t.result.is_following?e("span",{staticClass:"text-green-600 flex items-center gap-1 text-sm"},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"}})]),t._v(" Following ")]):t.result.is_pending?e("span",{staticClass:"text-yellow-600 flex items-center gap-1 text-sm"},[e("svg",{staticClass:"h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"}})]),t._v(" Pending ")]):t._e()])]),e("div",[!t.result.is_following&&!t.result.is_pending?e("button",{staticClass:"btn",attrs:{disabled:t.followLoading},on:{click:function(s){return t.follow(t.result.id)}}},[t._v(" "+t._s(t.followLoading?"Following...":"Follow")+" ")]):t._e(),t.followSuccess?e("div",{staticClass:"flex flex-col items-center animate-pulse text-green-600"},[e("span",{staticClass:"flex items-center gap-1 font-bold"},[e("svg",{staticClass:"h-5 w-5",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"}})]),t._v(" Request Sent! ")])]):t._e()])]):t._e()]):t._e()])},Ne=[],Se=i($e,je,Ne,!1,null,null);const Pe=Se.exports,Ae={components:{FollowingTitle:ye,FollowingList:b,ActorSearch:Pe},data(){return{loading:!0,myActors:[],actors:[],links:{},meta:{},endpoint:"/cp/activitypub/following/api"}},mounted(){this.fetchData()},methods:{fetchData(n=null){this.loading=!0;const t=n||this.endpoint;this.$axios.get(t).then(e=>{this.actors=e.data.actors.data,this.myActors=e.data.myActors;const s=e.data.actors;this.meta={current_page:s.current_page,last_page:s.last_page,from:s.from,to:s.to,total:s.total},this.links={prev:s.prev_page_url,next:s.next_page_url}}).catch(e=>{Statamic.$toast.error(e.message)}).finally(()=>{this.loading=!1})},fetchPage(n){n&&this.fetchData(n)},getFollowingFor(n){const t=n.following_ids||[];return this.actors.filter(e=>t.includes(e.id))},isBlocking(n,t){return(n.block_ids||[]).includes(t)},performAction(n,t,e){n==="unfollow"&&!confirm("Are you sure you want to unfollow this actor?")||n==="block"&&!confirm("Are you sure you want to block this actor?")||this.$axios.post("/cp/activitypub/"+n,{id:t,sender:e}).then(s=>{Statamic.$toast.success("Action "+n+" successful"),this.fetchData()}).catch(s=>{Statamic.$toast.error("Action failed: "+(s.response?.data?.error||s.message))})}}};var Fe=function(){var t=this,e=t._self._c;return e("div",[e("following-title"),e("actor-search",{on:{followed:t.fetchData}}),t.loading?e("div",{staticClass:"loading loading-basic"},[e("span",{staticClass:"icon icon-circular-graph animation-spin"}),t._v(" Loading... ")]):e("div",[t._l(t.myActors,function(s){return e("div",{key:s.id},[e("following-list",{attrs:{title:s.title+"'s Following",actors:t.getFollowingFor(s),"empty-text":"Not following anyone (on this page)."},scopedSlots:t._u([{key:"actions",fn:function({actor:o}){return[e("button",{staticClass:"btn-xs btn-default",on:{click:function(a){return t.performAction("unfollow",o.id,s.id)}}},[t._v("Unfollow")]),t.isBlocking(s,o.id)?e("button",{staticClass:"btn-xs btn-danger",on:{click:function(a){return t.performAction("unblock",o.id,s.id)}}},[t._v("Unblock")]):e("button",{staticClass:"btn-xs",on:{click:function(a){return t.performAction("block",o.id,s.id)}}},[t._v("Block")])]}}],null,!0)})],1)}),t.meta&&t.meta.last_page>1?e("div",{staticClass:"flex justify-between items-center mt-4"},[e("button",{staticClass:"btn",class:{"opacity-50":!t.links.prev},attrs:{disabled:!t.links.prev},on:{click:function(s){return t.fetchPage(t.links.prev)}}},[t._v("Previous")]),e("span",{staticClass:"text-sm text-gray-600"},[t._v("Page "+t._s(t.meta.current_page)+" of "+t._s(t.meta.last_page))]),e("button",{staticClass:"btn",class:{"opacity-50":!t.links.next},attrs:{disabled:!t.links.next},on:{click:function(s){return t.fetchPage(t.links.next)}}},[t._v("Next")])]):t._e()],2)],1)},Me=[],Ie=i(Ae,Fe,Me,!1,null,null);const Re=Ie.exports,qe={};var Be=function(){var t=this;return t._self._c,t._m(0)},Oe=[function(){var n=this,t=n._self._c;return t("div",{staticClass:"flex items-center justify-between mb-3"},[t("h1",[n._v("Followers")])])}],Ue=i(qe,Be,Oe,!1,null,null);const He={components:{FollowersTitle:Ue.exports,FollowingList:b},data(){return{loading:!0,myActors:[],actors:[],links:{},meta:{},endpoint:"/cp/activitypub/followers/api"}},mounted(){this.fetchData()},methods:{fetchData(n=null){this.loading=!0;const t=n||this.endpoint;this.$axios.get(t).then(e=>{this.actors=e.data.actors.data,this.myActors=e.data.myActors,this.links=e.data.actors.links||{prev:e.data.actors.prev_page_url,next:e.data.actors.next_page_url},this.meta=e.data.actors.meta||{current_page:e.data.actors.current_page,last_page:e.data.actors.last_page,from:e.data.actors.from,to:e.data.actors.to,total:e.data.actors.total}}).catch(e=>{Statamic.$toast.error(e.message)}).finally(()=>{this.loading=!1})},fetchPage(n){n&&this.fetchData(n)},getFollowersFor(n){const t=n.follower_ids||[];return this.actors.filter(e=>t.includes(e.id))},isFollowing(n,t){return(n.following_ids||[]).includes(t)},isBlocking(n,t){return(n.block_ids||[]).includes(t)},performAction(n,t,e){n==="unfollow"&&!confirm("Are you sure you want to unfollow this actor?")||n==="block"&&!confirm("Are you sure you want to block this actor?")||this.$axios.post("/cp/activitypub/"+n,{id:t,sender:e}).then(s=>{Statamic.$toast.success("Action "+n+" successful"),this.fetchData()}).catch(s=>{Statamic.$toast.error("Action failed: "+(s.response?.data?.error||s.message))})}}};var ze=function(){var t=this,e=t._self._c;return e("div",[e("followers-title"),t.loading?e("div",{staticClass:"loading loading-basic"},[e("span",{staticClass:"icon icon-circular-graph animation-spin"}),t._v(" Loading... ")]):e("div",[t._l(t.myActors,function(s){return e("div",{key:s.id},[e("following-list",{attrs:{title:s.title+"'s Followers",actors:t.getFollowersFor(s),"empty-text":"No followers found on this page."},scopedSlots:t._u([{key:"actions",fn:function({actor:o}){return[t.isFollowing(s,o.id)?e("button",{staticClass:"btn-xs btn-default",on:{click:function(a){return t.performAction("unfollow",o.id,s.id)}}},[t._v("Unfollow")]):e("button",{staticClass:"btn-xs btn-primary",on:{click:function(a){return t.performAction("follow",o.id,s.id)}}},[t._v("Follow Back")]),t.isBlocking(s,o.id)?e("button",{staticClass:"btn-xs btn-danger",on:{click:function(a){return t.performAction("unblock",o.id,s.id)}}},[t._v("Unblock")]):e("button",{staticClass:"btn-xs",on:{click:function(a){return t.performAction("block",o.id,s.id)}}},[t._v("Block")])]}}],null,!0)})],1)}),t.meta&&t.meta.last_page>1?e("div",{staticClass:"flex justify-between items-center mt-4"},[e("button",{staticClass:"btn",class:{"opacity-50":!t.links.prev},attrs:{disabled:!t.links.prev},on:{click:function(s){return t.fetchPage(t.links.prev)}}},[t._v("Previous")]),e("span",{staticClass:"text-sm text-gray-600"},[t._v("Page "+t._s(t.meta.current_page)+" of "+t._s(t.meta.last_page))]),e("button",{staticClass:"btn",class:{"opacity-50":!t.links.next},attrs:{disabled:!t.links.next},on:{click:function(s){return t.fetchPage(t.links.next)}}},[t._v("Next")])]):t._e()],2)],1)},Te=[],Ve=i(He,ze,Te,!1,null,null);const Le=Ve.exports,y=()=>{typeof Statamic<"u"?Statamic.booting(()=>{Statamic.$components.register("activity-pub-inbox",$t),Statamic.$components.register("activity-pub-log",At),Statamic.$components.register("actor_selector-fieldtype",qt),Statamic.$components.register("activity-pub-settings",ge),Statamic.$components.register("activity-pub-following",Re),Statamic.$components.register("activity-pub-followers",Le)}):setTimeout(y,10)};y()})();
